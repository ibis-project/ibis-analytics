# https://taskfile.dev
---
version: '3'

# version control variables
dotenv: ['.env']

tasks:
  # ingest data
  ingest-gh:
    cmds:
      - python src/ingest_gh.py
  ingest-ci:
    cmds:
      - python src/ingest_ci.py
  ingest-pypi:
    cmds:
      - python src/ingest_pypi.py
  ingest:
    cmds:
      - task: ingest-gh
      - task: ingest-ci
      - task: ingest-pypi
  # copy eda database to metrics database
  metrics:
    cmds:
      - python src/export_md.py
  export:
    cmds:
      - task: metrics
  # cleanup
  clean-data:
    cmds:
      - cmd: rm -r data/pypi
        ignore_error: true
      - cmd: rm -r data/github
        ignore_error: true
  clean-dbs:
    cmds:
      - cmd: rm *.ddb*
        ignore_error: true
  # streamlit stuff
  app:
    cmds:
      - streamlit run metrics.py
  st:
    cmds:
      - task: app
  streamlit:
    cmds:
      - task: app
